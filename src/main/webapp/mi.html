<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<HTML>
	<HEAD>
		<TITLE>Microsoft</TITLE>
		<META charset="UTF-8"/>
		<META name="viewport" content="width=device-width, initial-scale=1.0"/>
		<SCRIPT src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></SCRIPT> 
	</HEAD>
	<BODY>
		<A href="javascript:void(0)" id="div"><H1>授权码模式-点击</H1></A>
		<BR/>
		<HR/>
		<BR/>
		<A href="javascript:void(0)" id="div2"><H1>使用令牌-点击</H1></A>
		<DIV id="text"></DIV>
		<BR/>
		<HR/>
		<BR/>
		<A href="javascript:void(0)" id="div3"><H1>刷新令牌-点击</H1></A>
		<DIV id="text2"></DIV>
		<BR/>
		<HR/>
		<BR/>
		<A href="javascript:void(0)" id="div4"><H1>获取用户信息-点击</H1></A>
		<DIV id="text3"></DIV>
		<SCRIPT>
			//获取用户信息
			$("#div4").click(function () {
				$.get("/findMicrosftUser", {}, function (data) {
					$("#text3").text(data);
				});
			});
			//刷新令牌
			$("#div3").click(function () {
				$.get("/refreshMicrosftToken", {}, function (data) {
					$("#text2").text(data);
				});
			});
			//使用令牌
			$("#div2").click(function () {
				$.get("/useMicrosftToken", {}, function (data) {
					$("#text").text(data);
				});
			});
			//授权码模式
			$("#div").click(function () {
				var clientId = "e541cb7b-c24a-4211-991b-7c9ab25ad964";
				var A = window.open("https://login.microsoftonline.com/common/oauth2/v2.0/authorize?" +
					"client_id=" + clientId +
					"&response_type=code" +
					"&redirect_uri=http://localhost:8080/microsft" +
					"&response_mode=query" +
//					"&scope=Calendars.Read offline_access user.read openid profile" +
					"&scope=User.Read email offline_access openid profile" +
					"&state=1");
			});
		</SCRIPT>
	</BODY>
</HTML>
